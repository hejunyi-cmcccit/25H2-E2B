<mxfile host="Electron" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/29.0.3 Chrome/140.0.7339.249 Electron/38.7.0 Safari/537.36" version="29.0.3" pages="5">
  <diagram name="主流程" id="7Pbeld5ABGENB042kU9Q">
    <mxGraphModel dx="968" dy="725" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-141" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#ffe6cc;strokeColor=#d79b00;" vertex="1" parent="1">
          <mxGeometry x="190" y="90" width="510" height="1360" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-140" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="150" y="1460" width="516" height="1980" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-139" value="" style="rounded=0;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="184" y="3447" width="516" height="993" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-65" value="开始 run 方法" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="328" y="20" width="122" height="39" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-66" value="获取服务列表&#xa;cfg.GetServices()" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="297" y="109" width="184" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-67" value="不是生产环境 且 没有设置强制停止 且 需要启动的服务包括orchestrator&#xa;if !env.IsDevelopment() &amp;&amp; !config.ForceStop &amp;&amp; slices.Contains(services, cfg.Orchestrator)" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="228.5" y="237" width="320" height="252" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-68" value="创建文件锁&#xa;os.Create(OrchestratorLockPath)&#xa;defer 优雅关闭时删除" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="345" y="563" width="260" height="102" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-69" value="设置上下文和信号&#xa;context.WithCancel()&#xa;signal.NotifyContext(SIGINT, SIGTERM)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="259" y="715" width="260" height="102" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-70" value="初始化 Telemetry&#xa;telemetry.New()&#xa;defer Shutdown()" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="297" y="867" width="185" height="102" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-71" value="初始化日志记录器&#xa;- globalLogger&#xa;- sbxLoggerExternal&#xa;- sbxLoggerInternal&#xa;defer Sync()" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="288" y="1019" width="202" height="150" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-72" value="初始化核心组件&#xa;- sandboxes (共享 map)&#xa;- featureFlags&#xa;- limiter&#xa;- persistence (存储)&#xa;- blockMetrics&#xa;- templateCache&#xa;- clickhouse&#xa;- redis&#xa;- sandboxObserver" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="275" y="1219" width="228" height="222" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-73" value="启动 Sandbox Proxy&#xa;startService(&#39;sandbox proxy&#39;)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="259" y="1491" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-74" value="启动设备池&#xa;startService(&#39;nbd device pool&#39;)&#xa;devicePool.Populate()" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="259" y="1619" width="260" height="102" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-75" value="启动网络池&#xa;startService(&#39;network pool&#39;)&#xa;networkPool.Populate()" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="261" y="1771" width="257" height="102" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-76" value="创建 Sandbox Factory&#xa;sandbox.NewFactory()" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="279" y="1923" width="220" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-77" value="创建 Orchestrator 服务&#xa;server.New()" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="277" y="2051" width="225" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-78" value="启动 Hyperloop 服务器&#xa;startService(&#39;hyperloop server&#39;)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="259" y="2179" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-79" value="创建 gRPC 服务器&#xa;注册 Orchestrator 服务" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="277" y="2307" width="225" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-80" value="启用模板管理器?&#xa;TemplateManager in services" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="250" y="2435" width="278" height="278" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-81" value="创建模板管理器&#xa;tmplserver.New()&#xa;注册到 gRPC" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="365" y="2787" width="184" height="102" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-82" value="注册 Info 和 Health 服务&#xa;RegisterInfoServiceServer&#xa;RegisterHealthServer" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="272" y="2939" width="234" height="54" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-83" value="启动 CMUX 服务器&#xa;复用同一端口&#xa;startService(&#39;cmux server&#39;)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="264" y="3043" width="249" height="102" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-84" value="启动 HTTP 服务器&#xa;healthcheck handler&#xa;startService(&#39;http server&#39;)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="268" y="3195" width="242" height="102" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-85" value="启动 gRPC 服务器&#xa;startService(&#39;grpc server&#39;)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="270" y="3347" width="240" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-137" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-86" target="vzuIUtvpS1O6SNygQ2hP-135">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-86" value="等待关闭信号&#xa;case &lt;-sig.Done():&#xa;    case serviceErr := &lt;-serviceError:" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="269.5" y="3470" width="240" height="60" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-88" value="模板管理器存在?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="303" y="3920" width="172" height="80" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-89" value="等待模板管理器排空&#xa;tmpl.Wait(closeCtx)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="360" y="4073" width="204" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-90" value="按逆序关闭所有服务&#xa;for _, closer := range closers&#xa;closer.close(closeCtx)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="259" y="4201" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-91" value="等待所有g组中的所有startService协程完成&#xa;g.Wait()" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="295" y="4329" width="188" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-92" value="返回成功标志&#xa;return success" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="308" y="4457" width="163" height="78" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-93" value="结束" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="361" y="4585" width="57" height="39" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-94" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-65" target="vzuIUtvpS1O6SNygQ2hP-66">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-95" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-66" target="vzuIUtvpS1O6SNygQ2hP-67">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-96" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0.77;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-67" target="vzuIUtvpS1O6SNygQ2hP-68">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="475" y="526" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-97" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0.23;exitY=1;entryX=0.28;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-67" target="vzuIUtvpS1O6SNygQ2hP-69">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="302" y="526" />
              <mxPoint x="302" y="690" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-98" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.72;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-68" target="vzuIUtvpS1O6SNygQ2hP-69">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="475" y="690" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-99" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-69" target="vzuIUtvpS1O6SNygQ2hP-70">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-100" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-70" target="vzuIUtvpS1O6SNygQ2hP-71">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-101" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-71" target="vzuIUtvpS1O6SNygQ2hP-72">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-102" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-72" target="vzuIUtvpS1O6SNygQ2hP-73">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-103" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-73" target="vzuIUtvpS1O6SNygQ2hP-74">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-104" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-74" target="vzuIUtvpS1O6SNygQ2hP-75">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-105" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-75" target="vzuIUtvpS1O6SNygQ2hP-76">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-106" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-76" target="vzuIUtvpS1O6SNygQ2hP-77">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-107" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-77" target="vzuIUtvpS1O6SNygQ2hP-78">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-108" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-78" target="vzuIUtvpS1O6SNygQ2hP-79">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-109" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-79" target="vzuIUtvpS1O6SNygQ2hP-80">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-110" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0.69;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-80" target="vzuIUtvpS1O6SNygQ2hP-81">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="456" y="2750" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-111" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0.31;exitY=1;entryX=0.35;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-80" target="vzuIUtvpS1O6SNygQ2hP-82">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="322" y="2750" />
              <mxPoint x="322" y="2914" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-112" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.65;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-81" target="vzuIUtvpS1O6SNygQ2hP-82">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="456" y="2914" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-113" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-82" target="vzuIUtvpS1O6SNygQ2hP-83">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-114" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-83" target="vzuIUtvpS1O6SNygQ2hP-84">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-115" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-84" target="vzuIUtvpS1O6SNygQ2hP-85">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-116" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-85" target="vzuIUtvpS1O6SNygQ2hP-86">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-118" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-126" target="vzuIUtvpS1O6SNygQ2hP-88">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="389" y="3777.000000000001" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-127" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="vzuIUtvpS1O6SNygQ2hP-118">
          <mxGeometry x="-0.2576" y="-2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-119" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0.79;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-88" target="vzuIUtvpS1O6SNygQ2hP-89">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="461" y="4036" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-120" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0.21;exitY=1;entryX=0.33;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-88" target="vzuIUtvpS1O6SNygQ2hP-90">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="317" y="4036" />
              <mxPoint x="317" y="4176" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-121" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.67;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-89" target="vzuIUtvpS1O6SNygQ2hP-90">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="461" y="4176" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-122" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-90" target="vzuIUtvpS1O6SNygQ2hP-91">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-123" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-91" target="vzuIUtvpS1O6SNygQ2hP-92">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-124" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.49;entryY=0;rounded=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-92" target="vzuIUtvpS1O6SNygQ2hP-93">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-130" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=1;entryY=0;entryDx=0;entryDy=0;curved=1;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-125" target="vzuIUtvpS1O6SNygQ2hP-88">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="575" y="3910" />
              <mxPoint x="432" y="3910" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-125" value="标记服务为 Draining状态&#xa;serviceInfo.SetStatus(Draining)&#xa;&#xa;等待15秒populate给消费者" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="460" y="3800" width="230" height="90" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-126" value="服务当前是Healthy状态？" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="304" y="3700" width="172" height="80" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-133" style="rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0.528;entryY=-0.001;entryDx=0;entryDy=0;entryPerimeter=0;edgeStyle=orthogonalEdgeStyle;curved=1;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-126" target="vzuIUtvpS1O6SNygQ2hP-125">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="581" y="3760" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-134" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="vzuIUtvpS1O6SNygQ2hP-133">
          <mxGeometry x="-0.1454" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-138" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="vzuIUtvpS1O6SNygQ2hP-135" target="vzuIUtvpS1O6SNygQ2hP-126">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="vzuIUtvpS1O6SNygQ2hP-135" value="准备关闭上下文closeCtx&#xa;closeCtx, cancelCloseCtx := context.WithCancel(context.Background())&#xa;如果ForceStop，立即取消上下文" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="230" y="3580" width="320" height="95" as="geometry" />
        </mxCell>
        <mxCell id="TwPiq4Gogg4cyb5MshWB-1" value="&lt;div style=&quot;color: #c5c8c6;background-color: #1e1e1e;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #676867;&quot;&gt;*&lt;/span&gt;&lt;span style=&quot;color: #9b0000;&quot;&gt;Factory&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt; {&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;return&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #676867;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #9b0000;&quot;&gt;Factory&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;config&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;config&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;networkPool&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;networkPool&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;devicePool&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;devicePool&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;featureFlags&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;featureFlags&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="528" y="1900" width="300" height="180" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="4AhOZ1ngoLI9tqBNqCJS" name="Sandbox Proxy">
    <mxGraphModel dx="854" dy="640" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="bJeXMFjwXTu4Of700i03-1" value="开始创建 Sandbox Proxy" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="122.5" y="150" width="196" height="39" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-2" value="调用 NewSandboxProxy&#xa;proxy.NewSandboxProxy(&#xa;  MeterProvider,&#xa;  ProxyPort,&#xa;  sandboxes)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="101.5" y="239" width="238" height="150" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-70" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.25;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-3" target="bJeXMFjwXTu4Of700i03-58">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-3" value="定义请求处理器并创建Proxy对象&#xa;    getTargetFromRequest := reverseproxy.GetTargetFromRequest(env.IsLocal())&#xa;    proxy := reverseproxy.New(" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="70" y="430" width="300" height="81" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-10" value="创建Meter并注册指标&#xa;meterProvider.Meter(&#xa;  &#39;orchestrator.proxy.sandbox&#39;)&#xa;observer.Observe(&#xa;  CurrentServerConnections&#xa;/CurrentPoolConnections&#xa;/CurrentPoolSize)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="90" y="580" width="260" height="198" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-11" value="返回 SandboxProxy 对象" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="104" y="840" width="232" height="54" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-20" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-1" target="bJeXMFjwXTu4Of700i03-2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-21" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-2" target="bJeXMFjwXTu4Of700i03-3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-22" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-3" target="bJeXMFjwXTu4Of700i03-10">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="220" y="543" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-29" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-10" target="bJeXMFjwXTu4Of700i03-11">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-42" value="创建监听器并开始监听&#xa;l, err := lisCfg.Listen(&#xa;  ctx, &#39;tcp&#39;, p.Addr)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="853.5" y="239" width="214" height="102" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-49" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;exitDx=0;exitDy=0;shadow=1;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-57" target="bJeXMFjwXTu4Of700i03-42">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="960.5" y="189" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-57" value="启动服务&#xa;startService(&#39;sandbox proxy&#39;, ...)" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="862.5" y="150" width="196" height="39" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-58" value="从请求获取沙箱目标&#xa;sandboxId, port :=&#xa;getTargetFromRequest(r)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="462.5" y="567" width="239" height="102" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-59" value="查找沙箱&#xa;sbx, found := sandboxes.Get(sandboxId)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="452.5" y="719" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-60" value="访问令牌检查&#xa;accessToken =&#xa;net.GetIngress().TrafficAccessToken&#xa;isNonEnvdTraffic :=&#xa;port != DefaultEnvdServerPort" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="452.5" y="847" width="260" height="150" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-61" value="构造请求 Host&#xa;strings.ReplaceAll(h,&#xa;MaskRequestHostPortPlaceholder,&#xa;port)" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="452.5" y="1047" width="260" height="126" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-62" value="构造转发地址&#xa;url := &amp;amp;url.URL{&#xa;  Scheme: &#39;http&#39;,&#xa;  Host: sbx.Slot.HostIPString():port&#xa;}" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="452.5" y="1223" width="260" height="150" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-63" value="构造日志记录器" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="496.5" y="1423" width="172" height="54" as="geometry" />
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-64" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-58" target="bJeXMFjwXTu4Of700i03-59">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-65" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-59" target="bJeXMFjwXTu4Of700i03-60">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-66" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-60" target="bJeXMFjwXTu4Of700i03-61">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-67" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-61" target="bJeXMFjwXTu4Of700i03-62">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="bJeXMFjwXTu4Of700i03-68" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="bJeXMFjwXTu4Of700i03-62" target="bJeXMFjwXTu4Of700i03-63">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="XMqaDKqJ4jy8Q-5AIEWC-1" value="&lt;div style=&quot;background-color: rgb(30, 30, 30); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace; font-weight: normal; font-size: 14px; line-height: 19px; white-space: pre; color: rgb(197, 200, 198);&quot;&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;color: rgb(103, 104, 103);&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: rgb(155, 0, 0);&quot;&gt;Proxy&lt;/span&gt;&lt;span style=&quot;color: rgb(197, 200, 198);&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;Server&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #9b0000;&quot;&gt;http&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #9b0000;&quot;&gt;Server&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;Addr&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;fmt&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;.&lt;/span&gt;&lt;span style=&quot;color: #ce6700;&quot;&gt;Sprintf&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #9aa83a;&quot;&gt;&quot;:&lt;/span&gt;&lt;span style=&quot;color: #8080ff;&quot;&gt;%d&lt;/span&gt;&lt;span style=&quot;color: #9aa83a;&quot;&gt;&quot;&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;port&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;),&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;&quot;&gt;&lt;span style=&quot;color: rgb(197, 200, 198);&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;font color=&quot;#9872a2&quot;&gt;...&lt;/font&gt;&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;ReadHeaderTimeout&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;0&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;// 位置&lt;span style=&quot;animation: 0.25s ease 0s 1 normal none running fade-in; color: rgb(55, 148, 255); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 11.7px; white-space: normal;&quot;&gt;packages/shared/pkg/proxy&lt;/span&gt;&lt;span style=&quot;animation: 0.25s ease 0s 1 normal none running fade-in; color: rgb(55, 148, 255); font-family: Consolas, &amp;quot;Courier New&amp;quot;, monospace, Menlo, Monaco, &amp;quot;Courier New&amp;quot;, monospace; font-size: 11.7px; white-space: normal;&quot;&gt;/handler.go&lt;/span&gt;&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;// 调用 getDestination(r) &lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;white-space: pre;&quot;&gt;&#x9;&lt;/span&gt;// 从 HTTP 请求中解析出要转发到哪里&lt;br&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;Handler&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: #ce6700;&quot;&gt;handler&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;p&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;, &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;getDestination&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;),&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; },&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;pool&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;p&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div style=&quot;color: rgb(197, 200, 198);&quot;&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;}&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="402.5" y="210" width="390" height="193" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="LmHrC6nwauS3KQPE0qT_" name="Device Pool">
    <mxGraphModel dx="2642" dy="1360" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-164" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;curved=1;dashed=1;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-1" target="Ea2O-Yhj__mHChdnhqzT-143">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="-279" y="89" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-69" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-133" target="9CQ9KS83B-DSDtCItk3p-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-133" value="填充设备池&#xa;devicePool.Populate" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="330" y="178" width="205" height="78" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-134" value="注册关闭函数&#xa;append closers" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="350" y="306" width="167" height="78" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-135" value="结束" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="405" y="434" width="57" height="39" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-140" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.474;exitY=1.022;entryX=0.5;entryY=0;rounded=0;exitDx=0;exitDy=0;exitPerimeter=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-2" target="Ea2O-Yhj__mHChdnhqzT-133">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="433" y="128.00000000000006" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-141" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-133" target="Ea2O-Yhj__mHChdnhqzT-134">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-142" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.49;entryY=0;rounded=0;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-134" target="Ea2O-Yhj__mHChdnhqzT-135">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-143" value="创建设备池开始&#xa;NewDevicePool" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-269" y="190" width="143" height="63" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-144" value="获取最大设备数&#xa;getMaxDevices" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-283" y="303" width="172" height="78" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-145" value="获取成功?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-259" y="431" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-146" value="返回错误" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-360" y="691" width="124" height="54" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-147" value="maxDevices == 0?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-186" y="629" width="178" height="178" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-148" value="返回错误&#xa;max devices is 0" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-301" y="881" width="177" height="78" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-153" value="返回设备池对象&#xa;pool" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-67" y="890" width="172" height="78" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-154" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-143" target="Ea2O-Yhj__mHChdnhqzT-144">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-155" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-144" target="Ea2O-Yhj__mHChdnhqzT-145">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-156" value="失败" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.99;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-145" target="Ea2O-Yhj__mHChdnhqzT-146">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-298" y="592" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-157" value="成功" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.99;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-145" target="Ea2O-Yhj__mHChdnhqzT-147">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-97" y="592" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-158" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0.04;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-147" target="Ea2O-Yhj__mHChdnhqzT-148">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-213" y="844" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-159" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0.96;exitY=1;entryX=0.5;entryY=0;rounded=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-147" target="Ea2O-Yhj__mHChdnhqzT-153">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="19" y="844" />
            </Array>
            <mxPoint x="19" y="881" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-166" value="读文件&#xa;os.ReadFile(&quot;/sys/module/nbd/parameters/nbds_max&quot;)" style="whiteSpace=wrap;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-111" y="400" width="320" height="78" as="geometry" />
        </mxCell>
        <mxCell id="Ea2O-Yhj__mHChdnhqzT-167" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;curved=1;dashed=1;" edge="1" parent="1" source="Ea2O-Yhj__mHChdnhqzT-144">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="50" y="400" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-1" value="创建设备池&#xa;nbd.NewDevicePool" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-465" y="69.5" width="196" height="39" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-2" value="启动设备池服务&#xa;startService" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="339" y="69.5" width="196" height="39" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-3" value="填充设备池开始&#xa;Populate" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="810.5" y="290" width="143" height="63" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-6" value="进入循环" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="823" y="696" width="118" height="118" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-7" value="上下文是否取消?&#xa;ctx.Done&#xa;d.done" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="396" y="864" width="220" height="220" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-8" value="返回" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="352" y="2055" width="57" height="39" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-73" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-9" target="9CQ9KS83B-DSDtCItk3p-70">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-9" value="获取空闲设备槽&#xa;d.getFreeDeviceSlot" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="483" y="1158" width="205" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-10" value="获取成功?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="524" y="1286" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-11" value="失败次数&#xa;% 100 == 0?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="602" y="1484" width="158" height="158" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-12" value="记录错误日志&#xa;zap.L.Error" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="664" y="1716" width="156" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-13" value="增加失败计数&#xa;failedCount++" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="601" y="1864" width="160" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-14" value="等待 50 毫秒&#xa;time.Sleep" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="667" y="2090" width="150" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-15" value="重置失败计数&#xa;failedCount = 0" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="364" y="1524" width="170" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-16" value="增加槽位指标&#xa;slotCounter.Add" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="362" y="1716" width="174" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-17" value="选择操作" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="390" y="1844" width="118" height="118" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-18" value="写入设备槽到通道&#xa;d.slots &amp;lt;- device" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="860" y="2090" width="188" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-21" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-3" target="9CQ9KS83B-DSDtCItk3p-6">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="881.9999999999995" y="646" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-22" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.61;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-6" target="9CQ9KS83B-DSDtCItk3p-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="505" y="839" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-23" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.86;entryX=0.13;entryY=0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-7" target="9CQ9KS83B-DSDtCItk3p-8">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="300" y="1121" />
              <mxPoint x="300" y="1999" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-24" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0.77;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-7" target="9CQ9KS83B-DSDtCItk3p-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="585" y="1121" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-25" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-9" target="9CQ9KS83B-DSDtCItk3p-10">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-26" value="失败" style="curved=1;startArrow=none;endArrow=block;exitX=0.98;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-10" target="9CQ9KS83B-DSDtCItk3p-11">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="681" y="1447" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-27" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0.76;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-11" target="9CQ9KS83B-DSDtCItk3p-12">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="742" y="1679" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-28" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0.24;exitY=1;entryX=0.33;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-11" target="9CQ9KS83B-DSDtCItk3p-13">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="621" y="1679" />
              <mxPoint x="621" y="1819" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-29" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.68;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-12" target="9CQ9KS83B-DSDtCItk3p-13">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="742" y="1819" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-30" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.21;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-13" target="9CQ9KS83B-DSDtCItk3p-14">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="681" y="1999" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-31" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.86;exitY=0;entryX=0.43;entryY=1;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-14" target="9CQ9KS83B-DSDtCItk3p-6">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="871" y="1999" />
              <mxPoint x="871" y="839" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-32" value="成功" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.86;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-10" target="9CQ9KS83B-DSDtCItk3p-15">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="449" y="1447" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-33" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-15" target="9CQ9KS83B-DSDtCItk3p-16">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-34" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-16" target="9CQ9KS83B-DSDtCItk3p-17">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-35" value="上下文取消" style="curved=1;startArrow=none;endArrow=block;exitX=0.04;exitY=1;entryX=0.4;entryY=0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-17" target="9CQ9KS83B-DSDtCItk3p-8">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="360" y="1999" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-36" value="设备池关闭" style="curved=1;startArrow=none;endArrow=block;exitX=0.56;exitY=1;entryX=0.85;entryY=0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-17" target="9CQ9KS83B-DSDtCItk3p-8">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="460" y="1999" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-37" value="成功" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.6;entryX=0.22;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-17" target="9CQ9KS83B-DSDtCItk3p-18">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="907" y="1999" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-38" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.52;exitY=0;entryX=1;entryY=0.81;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-18" target="9CQ9KS83B-DSDtCItk3p-6">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1016" y="1999" />
              <mxPoint x="1016" y="839" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-40" value="初始化起始位置&#xa;start = 0" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1444" y="1343" width="172" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-41" value="进入循环" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1471" y="1471" width="118" height="118" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-102" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-42" target="9CQ9KS83B-DSDtCItk3p-83">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-42" value="获取可能空闲的槽&#xa;d.getMaybeEmptySlot" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1351" y="1639" width="215" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-43" value="找到槽位?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1397" y="1767" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-44" value="清理槽位&#xa;cleanup" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1294" y="1920" width="124" height="40" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-45" value="返回无空闲槽位错误&#xa;NoFreeSlotsError" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1214" y="2000" width="204" height="47" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-75" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-47" target="9CQ9KS83B-DSDtCItk3p-51">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-76" value="否" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="9CQ9KS83B-DSDtCItk3p-75">
          <mxGeometry x="-0.1354" y="5" relative="1" as="geometry">
            <mxPoint x="-1" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-137" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.5;exitDx=0;exitDy=0;curved=1;dashed=1;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-47" target="9CQ9KS83B-DSDtCItk3p-106">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-47" value="检查设备是否空闲&#xa;d.isDeviceFree" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1500" y="2000" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-48" value="清理槽位&#xa;cleanup" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1396.5" y="2160" width="124" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-49" value="返回检查错误" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1380.5" y="2260" width="156" height="54" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-51" value="清理槽位&#xa;cleanup" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1724" y="2120" width="124" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-52" value="递增起始位置&#xa;start++" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1820" y="2280" width="156" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-53" value="返回设备槽指针&#xa;*DeviceSlot" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1536.5" y="2360" width="172" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-55" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-40" target="9CQ9KS83B-DSDtCItk3p-41">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-56" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.08;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-41" target="9CQ9KS83B-DSDtCItk3p-42">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1459" y="1614" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-57" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-42" target="9CQ9KS83B-DSDtCItk3p-43">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-58" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.96;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-43" target="9CQ9KS83B-DSDtCItk3p-44">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1350" y="1860" />
            </Array>
            <mxPoint x="1370" y="1859" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-59" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-44" target="9CQ9KS83B-DSDtCItk3p-45">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-60" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.96;entryX=0.5;entryY=0;rounded=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-43" target="9CQ9KS83B-DSDtCItk3p-47">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1566" y="1928" />
            </Array>
            <mxPoint x="1566" y="1965" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-62" value="出错" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.75;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-47" target="9CQ9KS83B-DSDtCItk3p-48">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1470" y="2120" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-63" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=0.99;entryX=0.5;entryY=0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-48" target="9CQ9KS83B-DSDtCItk3p-49">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-64" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0.98;exitY=1;rounded=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-47" target="9CQ9KS83B-DSDtCItk3p-53">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1661" y="2254" />
            </Array>
            <mxPoint x="1660" y="2280" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-66" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1.01;entryX=0;entryY=0.75;rounded=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-51" target="9CQ9KS83B-DSDtCItk3p-52">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1750" y="2310" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-67" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=0;entryX=1;entryY=0.62;rounded=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-52" target="9CQ9KS83B-DSDtCItk3p-41">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1892" y="1614" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-74" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-70" target="9CQ9KS83B-DSDtCItk3p-40">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-70" value="获取空闲设备槽&#xa;d.getFreeDeviceSlot" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1458.5" y="1250" width="143" height="63" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-83" value="获取可能空闲的槽&#xa;getMaybeEmptySlot" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="2153" y="1790" width="175" height="63" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-84" value="获取互斥锁&#xa;d.mu.Lock" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="2171" y="1903" width="140" height="37" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-104" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-86" target="9CQ9KS83B-DSDtCItk3p-89">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2346" y="2125" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-105" value="是" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="9CQ9KS83B-DSDtCItk3p-104">
          <mxGeometry x="0.1753" y="-21" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-86" value="从bitSet查找下一个空闲位&#xa;d.usedSlots.NextClear" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="2160.5" y="2020" width="160" height="140" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-87" value="释放锁&#xa;d.mu.Unlock" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="2060" y="2210" width="151" height="60" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-88" value="返回未找到&#xa;ok = false" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="2065.5" y="2290" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-89" value="标记为已使用&#xa;d.usedSlots.Set" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="2261" y="2210" width="170" height="60" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-90" value="释放锁&#xa;d.mu.Unlock" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="2271" y="2338" width="151" height="52" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-91" value="创建清理函数&#xa;cleanup func" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="2271" y="2438" width="149" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-92" value="返回槽位和清理函数&#xa;slot, cleanup, ok = true" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="2270" y="2594" width="150" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-93" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-83" target="9CQ9KS83B-DSDtCItk3p-84">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-94" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-84" target="9CQ9KS83B-DSDtCItk3p-86">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="2240.5" y="1969" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-96" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0.01;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-86" target="9CQ9KS83B-DSDtCItk3p-87">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="2150" y="2130" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-97" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-87" target="9CQ9KS83B-DSDtCItk3p-88">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-99" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-89" target="9CQ9KS83B-DSDtCItk3p-90">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-100" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-90" target="9CQ9KS83B-DSDtCItk3p-91">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-101" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-91" target="9CQ9KS83B-DSDtCItk3p-92">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-106" value="检查设备是否空闲开始&#xa;isDeviceFree" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1117" y="2490" width="191" height="63" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-108" value="检查pid文件是否存在&#xa;/sys/block/nbdX/pid" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1120" y="2600" width="188" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-109" value="文件状态?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1152" y="2710" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-110" value="返回设备正在使用&#xa;false" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="910" y="2860" width="188" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-111" value="返回文件检查错误" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1120" y="2980" width="188" height="54" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-112" value="读取size文件内容&#xa;/sys/block/nbdX/size" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1354" y="2850" width="215" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-114" value="读取成功?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1399.5" y="2970" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-115" value="返回读取错误" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1282.5" y="3110" width="156" height="54" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-116" value="解析为 uint64&#xa;strconv.ParseUint" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1480" y="3110" width="184" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-117" value="解析成功?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1510" y="3230" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-118" value="返回解析错误" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1383.5" y="3380" width="156" height="54" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-119" value="size == 0?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1630" y="3380" width="122" height="122" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-120" value="返回设备空闲&#xa;true" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1501" y="3530" width="156" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-121" value="返回设备被占用&#xa;false" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1720" y="3530" width="172" height="78" as="geometry" />
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-122" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-106" target="9CQ9KS83B-DSDtCItk3p-108">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="1212" y="2603" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-124" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-108" target="9CQ9KS83B-DSDtCItk3p-109">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-125" value="文件存在" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.71;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-109" target="9CQ9KS83B-DSDtCItk3p-110">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1060" y="2800" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-126" value="其他错误" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-109" target="9CQ9KS83B-DSDtCItk3p-111">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-127" value="文件不存在" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.7;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-109" target="9CQ9KS83B-DSDtCItk3p-112">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1440" y="2800" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-128" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-112" target="9CQ9KS83B-DSDtCItk3p-114">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="1461.5" y="2968" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-130" value="失败" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.95;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-114" target="9CQ9KS83B-DSDtCItk3p-115">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1390" y="3061" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-131" value="成功" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.95;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-114" target="9CQ9KS83B-DSDtCItk3p-116">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1580" y="3080" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-132" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-116" target="9CQ9KS83B-DSDtCItk3p-117">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-133" value="失败" style="curved=1;startArrow=none;endArrow=block;exitX=0.02;exitY=1;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-117" target="9CQ9KS83B-DSDtCItk3p-118">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1490" y="3324" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-134" value="成功" style="curved=1;startArrow=none;endArrow=block;exitX=0.97;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-117" target="9CQ9KS83B-DSDtCItk3p-119">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-135" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.96;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-119" target="9CQ9KS83B-DSDtCItk3p-120">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1590" y="3490" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="9CQ9KS83B-DSDtCItk3p-136" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.96;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="1" source="9CQ9KS83B-DSDtCItk3p-119" target="9CQ9KS83B-DSDtCItk3p-121">
          <mxGeometry x="0.4936" y="9" relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1790" y="3470" />
            </Array>
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="uiHuvYIaKc2d6FJMs-Zb" name="Network Pool">
    <mxGraphModel dx="1795" dy="725" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="efSu_wHCLOfE-rcJZQTO-86" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="NPYvauIEaBKVAPcu_C31-7" target="efSu_wHCLOfE-rcJZQTO-32">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="NPYvauIEaBKVAPcu_C31-7" value="填充网络池&#xa;networkPool.Populate" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="630" y="190" width="217" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NPYvauIEaBKVAPcu_C31-8" value="注册关闭函数&#xa;append closers" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="655" y="300" width="167" height="78" as="geometry" />
        </mxCell>
        <mxCell id="NPYvauIEaBKVAPcu_C31-9" value="结束" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="710" y="418" width="57" height="39" as="geometry" />
        </mxCell>
        <mxCell id="NPYvauIEaBKVAPcu_C31-15" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;exitDx=0;exitDy=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-14" target="NPYvauIEaBKVAPcu_C31-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="859.4999999999995" y="158.0000000000001" as="sourcePoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="NPYvauIEaBKVAPcu_C31-16" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="NPYvauIEaBKVAPcu_C31-7" target="NPYvauIEaBKVAPcu_C31-8">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="NPYvauIEaBKVAPcu_C31-17" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="1" source="NPYvauIEaBKVAPcu_C31-8" target="NPYvauIEaBKVAPcu_C31-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-3" value="创建槽位存储开始&#xa;newStorage" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="-122" y="90" width="159" height="63" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-4" value="是否开发环境或&#xa;使用本地存储?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="-138" y="203" width="190" height="190" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-5" value="创建本地存储&#xa;network.NewStorageLocal" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-310" y="467" width="247" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-6" value="创建 KV 存储&#xa;network.NewStorageKV" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-13" y="467" width="228" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-7" value="返回存储对象&#xa;Storage" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="-121" y="595" width="156" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-8" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-3" target="efSu_wHCLOfE-rcJZQTO-4">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-9" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.96;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-4" target="efSu_wHCLOfE-rcJZQTO-5">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-186" y="430" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-10" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.96;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-4" target="efSu_wHCLOfE-rcJZQTO-6">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="101" y="430" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-11" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0;entryY=0.05;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-5" target="efSu_wHCLOfE-rcJZQTO-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="-186" y="570" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-12" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=1;entryY=0.05;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-6" target="efSu_wHCLOfE-rcJZQTO-7">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="101" y="570" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-14" value="启动网络池服务&#xa;startService" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="640.5" y="90" width="196" height="39" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-15" value="创建网络池开始&#xa;NewPool" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="330" y="90" width="143" height="63" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-24" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-15">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
            <mxPoint x="401.5" y="203" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-32" value="填充网络池开始&#xa;Populate" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="933" y="320" width="143" height="63" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-33" value="延迟关闭新槽位通道&#xa;defer close&#xa;p.newSlots" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="902" y="433" width="204" height="102" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-34" value="进入循环" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="945" y="585" width="118" height="118" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-35" value="上下文是否取消?&#xa;p.done&#xa;ctx.Done" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="620" y="753" width="220" height="220" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-36" value="返回" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="610" y="1066" width="57" height="39" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-84" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-37" target="efSu_wHCLOfE-rcJZQTO-53">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-37" value="创建网络槽位&#xa;p.createNetworkSlot" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="717" y="1047" width="208" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-38" value="创建成功?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="759" y="1175" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-39" value="记录错误日志&#xa;zap.L.Error" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="815" y="1373" width="156" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-40" value="增加槽位指标&#xa;newSlotsAvailableCounter.Add" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1021" y="1373" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-41" value="写入槽位到通道&#xa;p.newSlots &amp;lt;- slot" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1140" y="1501" width="188" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-42" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-32" target="efSu_wHCLOfE-rcJZQTO-33">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-43" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-33" target="efSu_wHCLOfE-rcJZQTO-34">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-44" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.65;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-34" target="efSu_wHCLOfE-rcJZQTO-35">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="730" y="728" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-45" value="是" style="curved=1;startArrow=none;endArrow=block;exitX=0.19;exitY=1;entryX=0.5;entryY=0.01;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-35" target="efSu_wHCLOfE-rcJZQTO-36">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="638" y="1010" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-46" value="否" style="curved=1;startArrow=none;endArrow=block;exitX=0.81;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-35" target="efSu_wHCLOfE-rcJZQTO-37">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="821" y="1010" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-47" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-37" target="efSu_wHCLOfE-rcJZQTO-38">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-48" value="失败" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.26;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-38" target="efSu_wHCLOfE-rcJZQTO-39">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="821" y="1336" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-49" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.87;exitY=0;entryX=0.5;entryY=1;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-39" target="efSu_wHCLOfE-rcJZQTO-34">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1004" y="1336" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-50" value="成功" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.65;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-38" target="efSu_wHCLOfE-rcJZQTO-40">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1151" y="1336" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-51" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.23;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-40" target="efSu_wHCLOfE-rcJZQTO-41">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1151" y="1476" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-52" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.77;exitY=0;entryX=1;entryY=0.63;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-41" target="efSu_wHCLOfE-rcJZQTO-34">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1316" y="1476" />
              <mxPoint x="1316" y="728" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-53" value="创建网络槽位开始&#xa;createNetworkSlot" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="1494" y="1299" width="164" height="63" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-54" value="从存储获取 IP 资源&#xa;p.slotStorage.Acquire" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1469" y="1412" width="215" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-55" value="获取成功?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1515" y="1540" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-56" value="返回错误" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1410" y="1750" width="124" height="54" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-83" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-57" target="efSu_wHCLOfE-rcJZQTO-70">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-57" value="创建网络命名空间&#xa;ips.CreateNetwork" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1584" y="1738" width="194" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-58" value="创建成功?" style="rhombus;strokeWidth=2;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="1619" y="1866" width="124" height="124" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-59" value="释放 IP 资源&#xa;p.slotStorage.Release" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1456" y="2064" width="215" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-60" value="返回错误" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1501" y="2192" width="124" height="54" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-61" value="返回槽位对象&#xa;*Slot" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1721" y="2064" width="156" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-62" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-53" target="efSu_wHCLOfE-rcJZQTO-54">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-63" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-54" target="efSu_wHCLOfE-rcJZQTO-55">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-64" value="失败" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.97;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-55" target="efSu_wHCLOfE-rcJZQTO-56">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1472" y="1701" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-65" value="成功" style="curved=1;startArrow=none;endArrow=block;exitX=0.99;exitY=0.97;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-55" target="efSu_wHCLOfE-rcJZQTO-57">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1681" y="1701" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-66" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-57" target="efSu_wHCLOfE-rcJZQTO-58">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-67" value="失败" style="curved=1;startArrow=none;endArrow=block;exitX=0;exitY=0.92;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-58" target="efSu_wHCLOfE-rcJZQTO-59">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1563" y="2027" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-68" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=-0.01;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-59" target="efSu_wHCLOfE-rcJZQTO-60">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-69" value="成功" style="curved=1;startArrow=none;endArrow=block;exitX=1;exitY=0.92;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="efSu_wHCLOfE-rcJZQTO-58" target="efSu_wHCLOfE-rcJZQTO-61">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="1799" y="2027" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-70" value="创建网络开始&#xa;CreateNetwork" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="2081" y="1880" width="139" height="63" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-75" value="在命名空间中配置网络&#xa;设置 IP、路由等" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="2040" y="2505" width="220" height="78" as="geometry" />
        </mxCell>
        <mxCell id="efSu_wHCLOfE-rcJZQTO-85" value="&lt;div style=&quot;color: #c5c8c6;background-color: #1e1e1e;font-family: Consolas, &#39;Courier New&#39;, monospace;font-weight: normal;font-size: 14px;line-height: 19px;white-space: pre;&quot;&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;pool&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #676867;&quot;&gt;:=&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #676867;&quot;&gt;&amp;amp;&lt;/span&gt;&lt;span style=&quot;color: #9b0000;&quot;&gt;Pool&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;{&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;config&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;config&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;done&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: #ce6700;&quot;&gt;make&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;(&lt;/span&gt;&lt;span style=&quot;color: #676867;&quot;&gt;chan&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt; &lt;/span&gt;&lt;span style=&quot;color: #676867;&quot;&gt;struct&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;{}),&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;newSlots&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;newSlots&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;reusedSlots&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;reusedSlots&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &lt;/span&gt;&lt;span style=&quot;color: #9872a2;&quot;&gt;slotStorage&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;: &lt;/span&gt;&lt;span style=&quot;color: #6089b4;&quot;&gt;slotStorage&lt;/span&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;,&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;color: #c5c8c6;&quot;&gt;&amp;nbsp; &amp;nbsp; }&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="text;whiteSpace=wrap;html=1;" vertex="1" parent="1">
          <mxGeometry x="260" y="218" width="350" height="160" as="geometry" />
        </mxCell>
        <mxCell id="bnN5272pNfRXu6S9TnOp-1" value="todo 3.1创建网络过程" style="text;html=1;whiteSpace=wrap;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;rounded=0;" vertex="1" parent="1">
          <mxGeometry x="2260" y="1930" width="60" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="v4yJJVaf1RSy8zul8Hu8" name="Hyperloop Server">
    <mxGraphModel dx="854" dy="640" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="n-efWzV1ppeqlbo0hUKU-7" value="监听并服务 HTTP 请求&#xa;hyperloopSrv.ListenAndServe" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="680" y="297" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-19" target="n-efWzV1ppeqlbo0hUKU-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-19" value="启动服务&#xa;startService" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="735" y="150" width="149" height="63" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-21" value="创建 Hyperloop 服务器开始&#xa;NewHyperloopServer" style="rounded=1;whiteSpace=wrap;arcSize=50;strokeWidth=2;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="205" y="150" width="225" height="63" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-22" value="获取日志收集器地址&#xa;env.LogsCollectorAddress" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="197" y="263" width="241" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-23" value="创建 Hyperloop 存储&#xa;handlers.NewHyperloopStore" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="187" y="391" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-52" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-24" target="n-efWzV1ppeqlbo0hUKU-27">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-24" value="获取 Swagger 规范&#xa;api.GetSwagger" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="221" y="519" width="193" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-53" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-27" target="n-efWzV1ppeqlbo0hUKU-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-54" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-27" target="n-efWzV1ppeqlbo0hUKU-31">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-27" value="创建 Gin 引擎&#xa;gin.New&#xa;gin.Use" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="238" y="650" width="158" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-28" value="添加恢复中间件&#xa;gin.Recovery" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="744" y="776" width="172" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-29" value="添加请求大小限制&#xa;limits.RequestSizeLimiter&#xa;256 MiB" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="708" y="904" width="243" height="102" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-30" value="添加 OpenAPI 验证器&#xa;middleware.OapiRequestValidator" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="700" y="1056" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="qGr8CenChSnLylrHDdhD-8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-31" target="n-efWzV1ppeqlbo0hUKU-35">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="qGr8CenChSnLylrHDdhD-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;curved=1;dashed=1;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-31" target="qGr8CenChSnLylrHDdhD-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-31" value="创建 HTTP 服务器&#xa;http.Server" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="223.5" y="800" width="187" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-35" value="注册 API 处理器&#xa;api.RegisterHandlersWithOptions" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="187" y="963" width="260" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-36" value="返回服务器对象&#xa;*http.Server" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="231" y="1091" width="172" height="78" as="geometry" />
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-37" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-21" target="n-efWzV1ppeqlbo0hUKU-22">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-38" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-22" target="n-efWzV1ppeqlbo0hUKU-23">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-39" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-23" target="n-efWzV1ppeqlbo0hUKU-24">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-44" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-28" target="n-efWzV1ppeqlbo0hUKU-29">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-45" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-29" target="n-efWzV1ppeqlbo0hUKU-30">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="n-efWzV1ppeqlbo0hUKU-51" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="n-efWzV1ppeqlbo0hUKU-35" target="n-efWzV1ppeqlbo0hUKU-36">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qGr8CenChSnLylrHDdhD-1" value="设置处理器&#xa;Handler = engine" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="478" y="904" width="182" height="78" as="geometry" />
        </mxCell>
        <mxCell id="qGr8CenChSnLylrHDdhD-2" value="设置监听地址&#xa;Addr = 0.0.0.0:port" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="470" y="1032" width="199" height="78" as="geometry" />
        </mxCell>
        <mxCell id="qGr8CenChSnLylrHDdhD-3" value="设置基础上下文&#xa;BaseContext" style="whiteSpace=wrap;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="483" y="1160" width="172" height="78" as="geometry" />
        </mxCell>
        <mxCell id="qGr8CenChSnLylrHDdhD-5" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="qGr8CenChSnLylrHDdhD-1" target="qGr8CenChSnLylrHDdhD-2">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
        <mxCell id="qGr8CenChSnLylrHDdhD-6" value="" style="curved=1;startArrow=none;endArrow=block;exitX=0.5;exitY=1;entryX=0.5;entryY=0;rounded=0;" edge="1" parent="1" source="qGr8CenChSnLylrHDdhD-2" target="qGr8CenChSnLylrHDdhD-3">
          <mxGeometry relative="1" as="geometry">
            <Array as="points" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
